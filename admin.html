<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>IELTS Test Editor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
    .container { max-width: 1000px; margin: 0 auto; background: white; border-radius: 10px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
    h1 { color: #333; margin-bottom: 30px; text-align: center; }
    .tabs { display: flex; margin-bottom: 30px; border-bottom: 2px solid #ddd; }
    .tab { padding: 15px 30px; cursor: pointer; border-bottom: 3px solid transparent; }
    .tab.active { border-bottom-color: #667eea; font-weight: bold; color: #667eea; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .form-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
    input, textarea, select { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px; }
    textarea { min-height: 100px; resize: vertical; }
    input:focus, textarea:focus, select:focus { outline: none; border-color: #667eea; }
    .form-row { display: flex; gap: 20px; }
    .form-row > div { flex: 1; }
    .btn { background: #667eea; color: white; border: none; padding: 12px 25px; border-radius: 6px; cursor: pointer; font-size: 16px; }
    .btn:hover { background: #5a67d8; }
    .btn-danger { background: #e53e3e; }
    .btn-success { background: #48bb78; }
    .tests-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
    .test-item { background: #f8f9fa; border: 2px solid #dee2e6; border-radius: 8px; padding: 15px; }
    .test-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .test-id { font-size: 20px; font-weight: bold; color: #667eea; }
    .test-status { padding: 3px 10px; border-radius: 15px; font-size: 12px; }
    .status-active { background: #d1fae5; color: #065f46; }
    .status-locked { background: #fee2e2; color: #991b1b; }
    .test-actions { margin-top: 10px; display: flex; gap: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîß IELTS Test Editor</h1>
    
    <div class="tabs">
      <div class="tab active" onclick="switchTab('edit')">Edit Existing Test</div>
      <div class="tab" onclick="switchTab('add')">Add New Test</div>
      <div class="tab" onclick="switchTab('manage')">Manage All Tests</div>
    </div>
    
    <!-- Edit Existing Test -->
    <div id="editTab" class="tab-content active">
      <h3>Edit Test</h3>
      <div class="form-group">
        <label>Select Test to Edit:</label>
        <select id="selectTest" onchange="loadTestForEdit()">
          <option value="">Select test...</option>
          <!-- Options will be populated by JavaScript -->
        </select>
      </div>
      
      <div id="editForm" style="display: none;">
        <div class="form-row">
          <div>
            <label>Test Number:</label>
            <input type="number" id="editId" min="1" max="30" readonly>
          </div>
          <div>
            <label>Status:</label>
            <select id="editStatus">
              <option value="active">Active (No password)</option>
              <option value="locked">Locked (Requires password)</option>
            </select>
          </div>
        </div>
        
        <div class="form-group">
          <label>Test Title:</label>
          <input type="text" id="editTitle" placeholder="e.g., Writing Set 1">
        </div>
        
        <div class="form-group">
          <label>Password (for locked tests):</label>
          <input type="text" id="editPassword" placeholder="Leave empty for no password">
        </div>
        
        <div class="form-group">
          <label>Task 1 Question:</label>
          <textarea id="editTask1Question" placeholder="Enter Task 1 question..."></textarea>
        </div>
        
        <div class="form-group">
          <label>Task 1 Image URL:</label>
          <input type="text" id="editTask1Image" placeholder="https://example.com/image.jpg">
        </div>
        
        <div class="form-group">
          <label>Task 2 Question:</label>
          <textarea id="editTask2Question" placeholder="Enter Task 2 question..."></textarea>
        </div>
        
        <button class="btn btn-success" onclick="saveTest()">üíæ Save Changes</button>
        <button class="btn btn-danger" onclick="deleteTest()">üóëÔ∏è Delete Test</button>
      </div>
    </div>
    
    <!-- Add New Test -->
    <div id="addTab" class="tab-content">
      <h3>Add New Test</h3>
      <div class="form-group">
        <label>Test Number (1-30):</label>
        <input type="number" id="newId" min="1" max="30" placeholder="1">
      </div>
      
      <div class="form-group">
        <label>Test Title:</label>
        <input type="text" id="newTitle" placeholder="e.g., Writing Set 1">
      </div>
      
      <div class="form-group">
        <label>Status:</label>
        <select id="newStatus">
          <option value="active">Active (No password)</option>
          <option value="locked">Locked (Requires password)</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Password (if locked):</label>
        <input type="text" id="newPassword" placeholder="Set a password for this test">
      </div>
      
      <div class="form-group">
        <label>Task 1 Question:</label>
        <textarea id="newTask1Question" placeholder="Enter Task 1 question..."></textarea>
      </div>
      
      <div class="form-group">
        <label>Task 1 Image URL:</label>
        <input type="text" id="newTask1Image" placeholder="https://example.com/image.jpg">
      </div>
      
      <div class="form-group">
        <label>Task 2 Question:</label>
        <textarea id="newTask2Question" placeholder="Enter Task 2 question..."></textarea>
      </div>
      
      <button class="btn btn-success" onclick="addNewTest()">‚ûï Add New Test</button>
    </div>
    
    <!-- Manage All Tests -->
    <div id="manageTab" class="tab-content">
      <h3>All Tests (1-30)</h3>
      <div class="tests-list" id="allTestsList">
        <!-- Tests will be displayed here -->
      </div>
      <div style="margin-top: 20px;">
        <button class="btn" onclick="exportTests()">üì§ Export Tests (JSON)</button>
        <button class="btn" onclick="importTests()">üì• Import Tests</button>
        <button class="btn btn-danger" onclick="resetAllTests()">üîÑ Reset All Tests</button>
      </div>
    </div>
  </div>
  
  <script>
    let tests = [];
    
    function loadTests() {
      const savedTests = localStorage.getItem('ielts_tests');
      if (savedTests) {
        tests = JSON.parse(savedTests);
      } else {
        tests = [];
        for (let i = 1; i <= 30; i++) {
          tests.push({
            id: i,
            title: `Writing Set ${i}`,
            status: i === 1 ? 'active' : 'locked',
            password: i === 1 ? '' : `test${i}`,
            task1: {
              question: i === 1 ? "The graph below shows the number of inquiries received by the Tourist Information Office in one city over a six-month period in 2011." : "Task 1 question",
              image: i === 1 ? "https://i.ibb.co/4RmQYKpw/line-grapht-task-one.jpg" : ""
            },
            task2: i === 1 ? "In many countries, traditional foods are being replaced by fast food. This has a negative impact on families, individuals, and society. To what extent do you agree or disagree?" : "Task 2 question"
          });
        }
        saveTests();
      }
      populateTestSelect();
      displayAllTests();
    }
    
    function saveTests() {
      localStorage.setItem('ielts_tests', JSON.stringify(tests));
    }
    
    function switchTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected tab
      document.getElementById(tabName + 'Tab').classList.add('active');
      event.target.classList.add('active');
    }
    
    function populateTestSelect() {
      const select = document.getElementById('selectTest');
      select.innerHTML = '<option value="">Select test...</option>';
      tests.forEach(test => {
        const option = document.createElement('option');
        option.value = test.id;
        option.textContent = `Test ${test.id}: ${test.title}`;
        select.appendChild(option);
      });
    }
    
    function loadTestForEdit() {
      const testId = parseInt(document.getElementById('selectTest').value);
      const test = tests.find(t => t.id === testId);
      
      if (test) {
        document.getElementById('editForm').style.display = 'block';
        document.getElementById('editId').value = test.id;
        document.getElementById('editTitle').value = test.title;
        document.getElementById('editStatus').value = test.status;
        document.getElementById('editPassword').value = test.password || '';
        document.getElementById('editTask1Question').value = test.task1.question;
        document.getElementById('editTask1Image').value = test.task1.image || '';
        document.getElementById('editTask2Question').value = test.task2;
      }
    }
    
    function saveTest() {
      const testId = parseInt(document.getElementById('editId').value);
      const index = tests.findIndex(t => t.id === testId);
      
      if (index !== -1) {
        tests[index] = {
          id: testId,
          title: document.getElementById('editTitle').value,
          status: document.getElementById('editStatus').value,
          password: document.getElementById('editPassword').value,
          task1: {
            question: document.getElementById('editTask1Question').value,
            image: document.getElementById('editTask1Image').value
          },
          task2: document.getElementById('editTask2Question').value
        };
        
        saveTests();
        alert('‚úÖ Test saved successfully!');
        loadTests();
      }
    }
    
    function deleteTest() {
      if (!confirm('Are you sure you want to delete this test?')) return;
      
      const testId = parseInt(document.getElementById('editId').value);
      const index = tests.findIndex(t => t.id === testId);
      
      if (index !== -1) {
        // Reset to default instead of deleting
        tests[index] = {
          id: testId,
          title: `Writing Set ${testId}`,
          status: 'locked',
          password: `test${testId}`,
          task1: { question: "Task 1 question", image: "" },
          task2: "Task 2 question"
        };
        
        saveTests();
        alert('‚úÖ Test reset to default!');
        loadTests();
        document.getElementById('editForm').style.display = 'none';
        document.getElementById('selectTest').value = '';
      }
    }
    
    function addNewTest() {
      const testId = parseInt(document.getElementById('newId').value);
      
      if (!testId || testId < 1 || testId > 30) {
        alert('Please enter a test number between 1 and 30');
        return;
      }
      
      // Check if test already exists
      const existingIndex = tests.findIndex(t => t.id === testId);
      
      const newTest = {
        id: testId,
        title: document.getElementById('newTitle').value || `Writing Set ${testId}`,
        status: document.getElementById('newStatus').value,
        password: document.getElementById('newPassword').value,
        task1: {
          question: document.getElementById('newTask1Question').value,
          image: document.getElementById('newTask1Image').value
        },
        task2: document.getElementById('newTask2Question').value
      };
      
      if (existingIndex !== -1) {
        tests[existingIndex] = newTest;
      } else {
        tests.push(newTest);
        tests.sort((a, b) => a.id - b.id); // Keep sorted
      }
      
      saveTests();
      alert('‚úÖ Test added/updated successfully!');
      
      // Clear form
      document.getElementById('newId').value = '';
      document.getElementById('newTitle').value = '';
      document.getElementById('newPassword').value = '';
      document.getElementById('newTask1Question').value = '';
      document.getElementById('newTask1Image').value = '';
      document.getElementById('newTask2Question').value = '';
      
      loadTests();
    }
    
    function displayAllTests() {
      const container = document.getElementById('allTestsList');
      container.innerHTML = '';
      
      for (let i = 1; i <= 30; i++) {
        const test = tests.find(t => t.id === i) || {
          id: i,
          title: `Writing Set ${i}`,
          status: 'not_created',
          task1: { question: '' },
          task2: ''
        };
        
        const div = document.createElement('div');
        div.className = 'test-item';
        div.innerHTML = `
          <div class="test-header">
            <div class="test-id">Test ${test.id}</div>
            <div class="test-status ${test.status === 'active' ? 'status-active' : test.status === 'locked' ? 'status-locked' : ''}">
              ${test.status === 'not_created' ? 'Not Created' : test.status}
            </div>
          </div>
          <div><strong>${test.title}</strong></div>
          <div style="font-size:12px;color:#666;margin-top:5px;">
            Task 1: ${test.task1.question.substring(0, 30)}...
          </div>
          <div class="test-actions">
            <button style="font-size:12px;padding:5px 10px;" onclick="editTest(${test.id})">Edit</button>
            <button style="font-size:12px;padding:5px 10px;" onclick="duplicateTest(${test.id})">Duplicate</button>
          </div>
        `;
        container.appendChild(div);
      }
    }
    
    function editTest(testId) {
      switchTab('edit');
      document.getElementById('selectTest').value = testId;
      loadTestForEdit();
    }
    
    function duplicateTest(testId) {
      const test = tests.find(t => t.id === testId);
      if (!test) return;
      
      // Find next available test number
      let newId = testId + 1;
      while (newId <= 30 && tests.find(t => t.id === newId)) {
        newId++;
      }
      
      if (newId > 30) {
        alert('Maximum 30 tests reached!');
        return;
      }
      
      const newTest = {
        ...test,
        id: newId,
        title: test.title + ' (Copy)'
      };
      
      tests.push(newTest);
      tests.sort((a, b) => a.id - b.id);
      saveTests();
      alert(`‚úÖ Test duplicated as Test ${newId}`);
      displayAllTests();
    }
    
    function exportTests() {
      const dataStr = JSON.stringify(tests, null, 2);
      const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
      
      const exportFileDefaultName = `ielts_tests_${new Date().toISOString().split('T')[0]}.json`;
      
      const linkElement = document.createElement('a');
      linkElement.setAttribute('href', dataUri);
      linkElement.setAttribute('download', exportFileDefaultName);
      linkElement.click();
    }
    
    function importTests() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      
      input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = event => {
          try {
            const importedTests = JSON.parse(event.target.result);
            if (Array.isArray(importedTests)) {
              tests = importedTests;
              saveTests();
              loadTests();
              alert('‚úÖ Tests imported successfully!');
            } else {
              alert('‚ùå Invalid file format!');
            }
          } catch (error) {
            alert('‚ùå Error reading file: ' + error.message);
          }
        };
        
        reader.readAsText(file);
      };
      
      input.click();
    }
    
    function resetAllTests() {
      if (!confirm('WARNING: This will reset ALL tests to default. Continue?')) return;
      
      tests = [];
      for (let i = 1; i <= 30; i++) {
        tests.push({
          id: i,
          title: `Writing Set ${i}`,
          status: i === 1 ? 'active' : 'locked',
          password: i === 1 ? '' : `test${i}`,
          task1: {
            question: i === 1 ? "The graph below shows the number of inquiries received by the Tourist Information Office in one city over a six-month period in 2011." : "Task 1 question",
            image: i === 1 ? "https://i.ibb.co/4RmQYKpw/line-grapht-task-one.jpg" : ""
          },
          task2: i === 1 ? "In many countries, traditional foods are being replaced by fast food. This has a negative impact on families, individuals, and society. To what extent do you agree or disagree?" : "Task 2 question"
        });
      }
      
      saveTests();
      alert('‚úÖ All tests reset to default!');
      loadTests();
    }
    
    // Initialize on page load
    window.onload = loadTests;
  </script>
</body>
</html>
